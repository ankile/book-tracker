import{R as te,H as L,aj as De,F as ce,M as Ne,L as Me,j as m,a1 as Pe,O as ze,P as He,Q as he,T as se,I as X,ak as Le,al as Oe,am as me,B as Fe,G as ve,K as Ue,an as xe,ao as Ae,ap as Ve,aq as Ee,ar as Ie,V as Ye,aa as ke,as as $e,C as Te,E as je,at as re,q as Ke,au as Ge,av as Qe,aw as Xe,ax as Je,ay as We,D as Ze,w as P,v as M,x as z,A as W,p as Re,b as ea,f as pe,a as Ce,y as ne,az as oe,s as U,o as V,t as Y,z as ie}from"./CmTovZ1L.js";import{f as B,t as Z,a as w,s as ee,d as aa,c as ta}from"./CQ5d6LE4.js";import{b as Se,f as sa,B as ge,q as le,o as ye,w as ra,h as O,i as de,j as F,k as ue,l as J,m as na,n as T,p as N,r as $,c as j}from"./DJTghN07.js";import{p as H,i as G}from"./CB2o9Wn4.js";function Aa(o,e){return e}function oa(o,e,a){for(var r=[],u=e.length,i=0;i<u;i++)Xe(e[i].e,r,!0);Je(r,()=>{var t=r.length===0&&a!==null;if(t){var l=a,s=l.parentNode;We(s),s.append(l),o.items.clear(),C(o,e[0].prev,e[u-1].next)}for(var p=0;p<u;p++){var f=e[p];t||(o.items.delete(f.k),C(o,f.prev,f.next)),Ze(f.e,!t)}o.first===e[0]&&(o.first=e[0].prev)})}function Ea(o,e,a,r,u,i=null){var t=o,l=new Map,s=null,p=(e&xe)!==0,f=(e&Ee)!==0,x=(e&Ie)!==0;if(p){var b=o;t=L?te(De(b)):b.appendChild(ce())}L&&Ne();var c=null,A=Pe(()=>{var h=a();return Ve(h)?h:h==null?[]:Ae(h)}),y,d=!0;function v(){ia(E,y,t,e,r),c!==null&&(y.length===0?(c.fragment?(t.before(c.fragment),c.fragment=null):Te(c.effect),S.first=c.effect):je(c.effect,()=>{c=null}))}var S=Me(()=>{y=m(A);var h=y.length;let q=!1;if(L){var g=ze(t)===He;g!==(h===0)&&(t=he(),te(t),se(!1),q=!0)}for(var I=new Set,n=Fe,_=null,D=Ue(),k=0;k<h;k+=1){L&&X.nodeType===Le&&X.data===Oe&&(t=X,q=!0,se(!1));var ae=y[k],Q=r(ae,k),R=d?null:l.get(Q);R?(f&&me(R.v,ae),x?me(R.i,k):R.i=k,D&&n.skipped_effects.delete(R.e)):(R=la(d?t:null,_,ae,Q,k,u,e,a),d&&(R.o=!0,_===null?s=R:_.next=R,_=R),l.set(Q,R)),I.add(Q)}if(h===0&&i&&!c)if(d)c={fragment:null,effect:ve(()=>i(t))};else{var _e=document.createDocumentFragment(),be=ce();_e.append(be),c={fragment:_e,effect:ve(()=>i(be))}}if(L&&h>0&&te(he()),!d)if(D){for(const[qe,Be]of l)I.has(qe)||n.skipped_effects.add(Be.e);n.oncommit(v),n.ondiscard(()=>{})}else v();q&&se(!0),m(A)}),E={effect:S,items:l,first:s};d=!1,L&&(t=X)}function ia(o,e,a,r,u){var i=(r&Ge)!==0,t=e.length,l=o.items,s=o.first,p,f=null,x,b=[],c=[],A,y,d,v;if(i)for(v=0;v<t;v+=1)A=e[v],y=u(A,v),d=l.get(y),d.o&&(d.a?.measure(),(x??=new Set).add(d));for(v=0;v<t;v+=1){if(A=e[v],y=u(A,v),d=l.get(y),o.first??=d,!d.o){d.o=!0;var S=f?f.next:s;C(o,f,d),C(o,d,S),fe(d,S,a),f=d,b=[],c=[],s=f.next;continue}if((d.e.f&re)!==0&&(Te(d.e),i&&(d.a?.unfix(),(x??=new Set).delete(d))),d!==s){if(p!==void 0&&p.has(d)){if(b.length<c.length){var E=c[0],h;f=E.prev;var q=b[0],g=b[b.length-1];for(h=0;h<b.length;h+=1)fe(b[h],E,a);for(h=0;h<c.length;h+=1)p.delete(c[h]);C(o,q.prev,g.next),C(o,f,q),C(o,g,E),s=E,f=g,v-=1,b=[],c=[]}else p.delete(d),fe(d,s,a),C(o,d.prev,d.next),C(o,d,f===null?o.first:f.next),C(o,f,d),f=d;continue}for(b=[],c=[];s!==null&&s.k!==y;)(s.e.f&re)===0&&(p??=new Set).add(s),c.push(s),s=s.next;if(s===null)continue;d=s}b.push(d),f=d,s=d.next}let I=l.size>t;if(s!==null||p!==void 0){for(var n=p===void 0?[]:Ae(p);s!==null;)(s.e.f&re)===0&&n.push(s),s=s.next;var _=n.length;if(I=l.size-_>t,_>0){var D=(r&xe)!==0&&t===0?a:null;if(i){for(v=0;v<_;v+=1)n[v].a?.measure();for(v=0;v<_;v+=1)n[v].a?.fix()}oa(o,n,D)}}if(I)for(const k of l.values())k.o||(C(o,f,k),f=k);o.effect.last=f&&f.e,i&&Ke(()=>{if(x!==void 0)for(d of x)d.a?.apply()})}function la(o,e,a,r,u,i,t,l){var s=(t&Ee)!==0,p=(t&$e)===0,f=s?p?Ye(a,!1,!1):ke(a):a,x=(t&Ie)===0?u:ke(u),b={i:x,v:f,k:r,a:null,e:null,o:!1,prev:e,next:null};try{if(o===null){var c=document.createDocumentFragment();c.append(o=ce())}return b.e=ve(()=>i(o,f,x,l)),e!==null&&(e.next=b),b}finally{}}function fe(o,e,a){for(var r=o.next?o.next.e.nodes_start:a,u=e?e.e.nodes_start:a,i=o.e.nodes_start;i!==null&&i!==r;){var t=Qe(i);u.before(i),i=t}}function C(o,e,a){e===null?(o.first=a,o.effect.first=a&&a.e):(e.e.next&&(e.e.next.prev=null),e.next=a,e.e.next=a&&a.e),a!==null&&(a.e.prev&&(a.e.prev.next=null),a.prev=e,a.e.prev=e&&e.e)}var da=B("<label> </label>"),ua=B('<div class="column svelte-8ff5h4"><!> <!></div>');function K(o,e){let a=H(e,"inputId",3,void 0);var r=ua(),u=P(r);{var i=l=>{var s=da(),p=P(s,!0);z(s),W(()=>{sa(s,"for",a()),ee(p,e.label)}),w(l,s)};G(u,l=>{e.label&&l(i)})}var t=M(u,2);Se(t,e,"default",{},l=>{var s=Z("Yeet");w(l,s)}),z(r),w(o,r)}var fa=B('<h4 class="header"> </h4> <div class="divider svelte-1qzjm47"></div>',1),ca=B('<div role="presentation" class="background svelte-1qzjm47"><div class="card hover svelte-1qzjm47"><!> <div class="content svelte-1qzjm47"><!></div> <div class="divider svelte-1qzjm47"></div> <div class="buttons svelte-1qzjm47"><!> <!></div></div></div>');function va(o,e){Re(e,!0);let a=H(e,"header",3,void 0),r=H(e,"primaryAction",3,void 0),u=H(e,"primaryText",3,"Do it!"),i=H(e,"secondaryText",3,"Close"),t=H(e,"hideSecondary",3,!1);ea(()=>(window.addEventListener("keydown",s),()=>window.removeEventListener("keydown",s)));const l=()=>e.onclose();function s(b){r()&&b.key==="Enter"?r()():b.key==="Escape"&&l()}var p=ta(),f=pe(p);{var x=b=>{var c=ca();c.__click=l,c.__keydown=n=>n.key==="Escape"&&l();var A=P(c);A.__click=n=>n.stopPropagation(),A.__keydown=n=>n.stopPropagation();var y=P(A);{var d=n=>{var _=fa(),D=pe(_),k=P(D,!0);z(D),ne(2),W(()=>ee(k,a())),w(n,_)};G(y,n=>{a()&&n(d)})}var v=M(y,2),S=P(v);Se(S,e,"default",{},n=>{var _=Z("No content");w(n,_)}),z(v);var E=M(v,4),h=P(E);{var q=n=>{ge(n,{onclick:l,children:(_,D)=>{ne();var k=Z();W(()=>ee(k,i())),w(_,k)},$$slots:{default:!0}})};G(h,n=>{t()||n(q)})}var g=M(h,2);{var I=n=>{ge(n,{primary:!0,get onclick(){return r()},children:(_,D)=>{ne();var k=Z();W(()=>ee(k,u())),w(_,k)},$$slots:{default:!0}})};G(g,n=>{r()&&n(I)})}z(E),z(A),z(c),w(b,c)};G(f,b=>{e.open&&b(x)})}w(o,p),Ce()}aa(["click","keydown"]);class we{static getBooks(e,a){const r=oe([]),u=le(O(T,"users",e,"books"),ra("finished","==",a),ye("updatedAt","desc")),i=de(u,t=>{const l=[];t.forEach(s=>{l.push({id:s.id,...s.data()})}),r.set(l)});return{subscribe:r.subscribe,unsubscribe:i}}static getAllBooks(e){const a=oe([]),r=le(O(T,"users",e,"books"),ye("createdAt","desc")),u=de(r,i=>{const t=[];i.forEach(l=>{t.push({id:l.id,...l.data()})}),a.set(t)});return{subscribe:a.subscribe,unsubscribe:u}}static async addPageUpdate({userId:e,id:a,currentPage:r,previousPage:u}){const i=F(T,"users",e,"books",a);await ue(O(T,"users",e,"books",a,"updates"),{book:i,type:"update",fromPage:u,toPage:r,pagesRead:r-u,updatedAt:N(),createdAt:N()}),await J(i,{currentPage:r})}static async addReading({userId:e,id:a,previousPage:r,currentPage:u,timeRead:i}){const t=F(T,"users",e,"books",a);await ue(O(T,"users",e,"books",a,"updates"),{book:t,type:"reading",timeRead:i,fromPage:r,toPage:u,pagesRead:u-r,updatedAt:N(),createdAt:N()}),await J(t,{currentPage:u})}static async addBook({userId:e,author:a,title:r,pageCount:u,currentPage:i,isbn:t}){const l=F(T,"users",e);await ue(O(T,"users",e,"books"),{author:a,currentPage:i,finished:!1,owner:l,pageCount:u,pagesRead:0,timeRead:0,title:r,isbn:t,updatedAt:N(),createdAt:N()})}static async updateBook({userId:e,bookId:a,author:r,title:u,pageCount:i,isbn:t}){const l=F(T,"users",e,"books",a);await J(l,{author:r,title:u,pageCount:i,isbn:t,updatedAt:N()})}static async deleteBook(e,a){const r=F(T,"users",e,"books",a);await na(r)}static async updateReadingSession({userId:e,bookId:a,sessionId:r,timeRead:u,fromPage:i,toPage:t}){const l=F(T,"users",e,"books",a,"updates",r);await J(l,{timeRead:u,fromPage:i,toPage:t,pagesRead:t-i,updatedAt:N()})}static getReadingSessions(e,a){const r=oe([]),u=le(O(T,"users",e,"books",a,"updates")),i=de(u,t=>{const l=[];t.forEach(s=>{const p=s.data();p.type==="reading"&&l.push({id:s.id,...p})}),l.sort((s,p)=>{const f=s.createdAt?.toMillis?.()||0;return(p.createdAt?.toMillis?.()||0)-f}),r.set(l)});return{subscribe:r.subscribe,unsubscribe:i}}}var pa=B('<input id="author" class="form-control" type="text" placeholder="Name of author(s)"/>'),_a=B('<input id="title" class="form-control" type="text" placeholder="Book title"/>'),ba=B('<input id="pageCount" class="form-control" type="number" placeholder="How many pages are there?"/>'),ha=B('<input id="currentPage" class="form-control" type="number" placeholder="Have you already started reading?"/>'),ma=B('<input id="isbn" class="form-control" type="text" placeholder="ISBN"/>'),ka=B('<!> <div class="space svelte-p2qnds"></div> <!> <div class="space svelte-p2qnds"></div> <!> <div class="space svelte-p2qnds"></div> <!> <div class="space svelte-p2qnds"></div> <!>',1);function Ia(o,e){Re(e,!0);let a=H(e,"book",3,null),r=U(V(a()?a().author:"")),u=U(V(a()?a().title:"")),i=U(V(a()?a().pageCount:void 0)),t=U(V(a()?a().currentPage:1)),l=U(V(a()?a().isbn:"")),s=ie(()=>!!a());function p(){we.addBook({userId:e.userId,author:m(r),title:m(u),pageCount:m(i),currentPage:m(t),isbn:m(l)}),e.onclose()}function f(){we.updateBook({userId:e.userId,bookId:a().id,author:m(r),title:m(u),pageCount:m(i),isbn:m(l)}),e.onclose()}function x(){m(s)?f():p()}{let b=ie(()=>m(s)?"Edit book":"Add new book"),c=ie(()=>m(s)?"Update book":"Add book");va(o,{get open(){return e.open},onclose:()=>e.onclose(),get header(){return m(b)},get primaryText(){return m(c)},primaryAction:x,children:(A,y)=>{var d=ka(),v=pe(d);K(v,{label:"Author",inputId:"author",children:(g,I)=>{var n=pa();$(n),j(n,()=>m(r),_=>Y(r,_)),w(g,n)},$$slots:{default:!0}});var S=M(v,4);K(S,{label:"Book title",inputId:"title",children:(g,I)=>{var n=_a();$(n),j(n,()=>m(u),_=>Y(u,_)),w(g,n)},$$slots:{default:!0}});var E=M(S,4);K(E,{label:"Number of pages",inputId:"pageCount",children:(g,I)=>{var n=ba();$(n),j(n,()=>m(i),_=>Y(i,_)),w(g,n)},$$slots:{default:!0}});var h=M(E,4);K(h,{label:"Current page",inputId:"currentPage",children:(g,I)=>{var n=ha();$(n),j(n,()=>m(t),_=>Y(t,_)),w(g,n)},$$slots:{default:!0}});var q=M(h,4);K(q,{label:"ISBN number (optional)",inputId:"isbn",children:(g,I)=>{var n=ma();$(n),j(n,()=>m(l),_=>Y(l,_)),w(g,n)},$$slots:{default:!0}}),w(A,d)},$$slots:{default:!0}})}Ce()}function Ta(o){return`${String(Math.floor(o/60)).padStart(2,"0")}:${String(o%60).padStart(2,"0")}`}export{we as D,K as I,va as M,Ia as N,Ea as e,Ta as f,Aa as i};

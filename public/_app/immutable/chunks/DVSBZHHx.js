import{H as z,M as Ne,L as Se,j as k,a1 as Pe,O as Me,P as ze,Q as pe,R as ae,T as te,I as Q,aj as He,ak as Le,al as _e,B as Oe,G as de,K as $e,am as we,an as Fe,F as ue,V as Ue,aa as he,ao as Ee,ap as Ae,aq as Ve,C as Ie,E as Ye,ar as re,as as je,at as Ke,au as Ge,av as Qe,D as Xe,aw as Je,q as We,ax as Te,ay as Ze,w as P,v as N,x as M,A as X,p as Ce,b as ea,f as fe,a as Be,y as se,az as be,s as L,o as O,t as $,z as ne}from"./CZfOPRqT.js";import{f as D,t as J,a as y,s as W,d as aa,c as ta}from"./CaXebpQC.js";import{b as qe,f as ra,B as me,q as ke,o as ge,w as sa,h as F,i as xe,j as U,k as oe,l as ie,m as na,n as R,p as S,r as V,c as Y}from"./BQ1gbXSc.js";import{p as H,i as Z}from"./DQnj7vM9.js";function Ea(r,e){return e}function oa(r,e,a){for(var n=[],d=e.length,i=0;i<d;i++)Ke(e[i].e,n,!0);Ge(n,()=>{var t=n.length===0&&a!==null;if(t){var l=a,s=l.parentNode;Qe(s),s.append(l),r.items.clear(),B(r,e[0].prev,e[d-1].next)}for(var m=0;m<d;m++){var c=e[m];t||(r.items.delete(c.k),B(r,c.prev,c.next)),Xe(c.e,!t)}r.first===e[0]&&(r.first=e[0].prev)})}function Aa(r,e,a,n,d,i=null){var t=r,l=new Map,s=null,m=(e&Te)!==0,c=(e&Ae)!==0,g=(e&Ee)!==0;if(m){var _=r;t=z?ae(Je(_)):_.appendChild(ue())}z&&Ne();var v=null,E=Pe(()=>{var b=a();return Fe(b)?b:b==null?[]:we(b)}),w,o=!0;function p(){ia(A,w,t,e,n),v!==null&&(w.length===0?(v.fragment?(t.before(v.fragment),v.fragment=null):Ie(v.effect),I.first=v.effect):Ye(v.effect,()=>{v=null}))}var I=Se(()=>{w=k(E);var b=w.length;let q=!1;if(z){var f=Me(t)===ze;f!==(b===0)&&(t=pe(),ae(t),te(!1),q=!0)}for(var x=new Set,u=Oe,h=null,K=$e(),T=0;T<b;T+=1){z&&Q.nodeType===He&&Q.data===Le&&(t=Q,q=!0,te(!1));var ee=w[T],G=n(ee,T),C=o?null:l.get(G);C?(c&&_e(C.v,ee),g?_e(C.i,T):C.i=T,K&&u.skipped_effects.delete(C.e)):(C=la(o?t:null,h,ee,G,T,d,e,a),o&&(C.o=!0,h===null?s=C:h.next=C,h=C),l.set(G,C)),x.add(G)}if(b===0&&i&&!v)if(o)v={fragment:null,effect:de(()=>i(t))};else{var ce=document.createDocumentFragment(),ve=ue();ce.append(ve),v={fragment:ce,effect:de(()=>i(ve))}}if(z&&b>0&&ae(pe()),!o)if(K){for(const[Re,De]of l)x.has(Re)||u.skipped_effects.add(De.e);u.oncommit(p),u.ondiscard(()=>{})}else p();q&&te(!0),k(E)}),A={effect:I,items:l,first:s};o=!1,z&&(t=Q)}function ia(r,e,a,n,d){var i=(n&Ze)!==0,t=e.length,l=r.items,s=r.first,m,c=null,g,_=[],v=[],E,w,o,p;if(i)for(p=0;p<t;p+=1)E=e[p],w=d(E,p),o=l.get(w),o.o&&(o.a?.measure(),(g??=new Set).add(o));for(p=0;p<t;p+=1){if(E=e[p],w=d(E,p),o=l.get(w),r.first??=o,!o.o){o.o=!0;var I=c?c.next:s;B(r,c,o),B(r,o,I),le(o,I,a),c=o,_=[],v=[],s=c.next;continue}if((o.e.f&re)!==0&&(Ie(o.e),i&&(o.a?.unfix(),(g??=new Set).delete(o))),o!==s){if(m!==void 0&&m.has(o)){if(_.length<v.length){var A=v[0],b;c=A.prev;var q=_[0],f=_[_.length-1];for(b=0;b<_.length;b+=1)le(_[b],A,a);for(b=0;b<v.length;b+=1)m.delete(v[b]);B(r,q.prev,f.next),B(r,c,q),B(r,f,A),s=A,c=f,p-=1,_=[],v=[]}else m.delete(o),le(o,s,a),B(r,o.prev,o.next),B(r,o,c===null?r.first:c.next),B(r,c,o),c=o;continue}for(_=[],v=[];s!==null&&s.k!==w;)(s.e.f&re)===0&&(m??=new Set).add(s),v.push(s),s=s.next;if(s===null)continue;o=s}_.push(o),c=o,s=o.next}let x=l.size>t;if(s!==null||m!==void 0){for(var u=m===void 0?[]:we(m);s!==null;)(s.e.f&re)===0&&u.push(s),s=s.next;var h=u.length;if(x=l.size-h>t,h>0){var K=(n&Te)!==0&&t===0?a:null;if(i){for(p=0;p<h;p+=1)u[p].a?.measure();for(p=0;p<h;p+=1)u[p].a?.fix()}oa(r,u,K)}}if(x)for(const T of l.values())T.o||(B(r,c,T),c=T);r.effect.last=c&&c.e,i&&We(()=>{if(g!==void 0)for(o of g)o.a?.apply()})}function la(r,e,a,n,d,i,t,l){var s=(t&Ae)!==0,m=(t&Ve)===0,c=s?m?Ue(a,!1,!1):he(a):a,g=(t&Ee)===0?d:he(d),_={i:g,v:c,k:n,a:null,e:null,o:!1,prev:e,next:null};try{if(r===null){var v=document.createDocumentFragment();v.append(r=ue())}return _.e=de(()=>i(r,c,g,l)),e!==null&&(e.next=_),_}finally{}}function le(r,e,a){for(var n=r.next?r.next.e.nodes_start:a,d=e?e.e.nodes_start:a,i=r.e.nodes_start;i!==null&&i!==n;){var t=je(i);d.before(i),i=t}}function B(r,e,a){e===null?(r.first=a,r.effect.first=a&&a.e):(e.e.next&&(e.e.next.prev=null),e.next=a,e.e.next=a&&a.e),a!==null&&(a.e.prev&&(a.e.prev.next=null),a.prev=e,a.e.prev=e&&e.e)}var da=D("<label> </label>"),ua=D('<div class="column svelte-8ff5h4"><!> <!></div>');function j(r,e){let a=H(e,"inputId",3,void 0);var n=ua(),d=P(n);{var i=l=>{var s=da(),m=P(s,!0);M(s),X(()=>{ra(s,"for",a()),W(m,e.label)}),y(l,s)};Z(d,l=>{e.label&&l(i)})}var t=N(d,2);qe(t,e,"default",{},l=>{var s=J("Yeet");y(l,s)}),M(n),y(r,n)}var fa=D('<h4 class="header"> </h4> <div class="divider svelte-1qzjm47"></div>',1),ca=D('<div role="presentation" class="background svelte-1qzjm47"><div class="card hover svelte-1qzjm47"><!> <div class="content svelte-1qzjm47"><!></div> <div class="divider svelte-1qzjm47"></div> <div class="buttons svelte-1qzjm47"><!> <!></div></div></div>');function va(r,e){Ce(e,!0);let a=H(e,"header",3,void 0),n=H(e,"primaryAction",3,void 0),d=H(e,"primaryText",3,"Do it!"),i=H(e,"secondaryText",3,"Close");ea(()=>(window.addEventListener("keydown",l),()=>window.removeEventListener("keydown",l)));const t=()=>e.onclose();function l(g){n()&&g.key==="Enter"?n()():g.key==="Escape"&&t()}var s=ta(),m=fe(s);{var c=g=>{var _=ca();_.__click=t,_.__keydown=f=>f.key==="Escape"&&t();var v=P(_);v.__click=f=>f.stopPropagation(),v.__keydown=f=>f.stopPropagation();var E=P(v);{var w=f=>{var x=fa(),u=fe(x),h=P(u,!0);M(u),se(2),X(()=>W(h,a())),y(f,x)};Z(E,f=>{a()&&f(w)})}var o=N(E,2),p=P(o);qe(p,e,"default",{},f=>{var x=J("No content");y(f,x)}),M(o);var I=N(o,4),A=P(I);me(A,{onclick:t,children:(f,x)=>{se();var u=J();X(()=>W(u,i())),y(f,u)},$$slots:{default:!0}});var b=N(A,2);{var q=f=>{me(f,{primary:!0,get onclick(){return n()},children:(x,u)=>{se();var h=J();X(()=>W(h,d())),y(x,h)},$$slots:{default:!0}})};Z(b,f=>{n()&&f(q)})}M(I),M(v),M(_),y(g,_)};Z(m,g=>{e.open&&g(c)})}y(r,s),Be()}aa(["click","keydown"]);class ye{static getBooks(e,a){const n=be([]),d=ke(F(R,"users",e,"books"),sa("finished","==",a),ge("updatedAt","desc")),i=xe(d,t=>{const l=[];t.forEach(s=>{l.push({id:s.id,...s.data()})}),n.set(l)});return{subscribe:n.subscribe,unsubscribe:i}}static getAllBooks(e){const a=be([]),n=ke(F(R,"users",e,"books"),ge("createdAt","desc")),d=xe(n,i=>{const t=[];i.forEach(l=>{t.push({id:l.id,...l.data()})}),a.set(t)});return{subscribe:a.subscribe,unsubscribe:d}}static async addPageUpdate({userId:e,id:a,currentPage:n,previousPage:d}){const i=U(R,"users",e,"books",a);await oe(F(R,"users",e,"books",a,"updates"),{book:i,type:"update",fromPage:d,toPage:n,pagesRead:n-d,updatedAt:S(),createdAt:S()}),await ie(i,{currentPage:n})}static async addReading({userId:e,id:a,previousPage:n,currentPage:d,timeRead:i}){const t=U(R,"users",e,"books",a);await oe(F(R,"users",e,"books",a,"updates"),{book:t,type:"reading",timeRead:i,fromPage:n,toPage:d,pagesRead:d-n,updatedAt:S(),createdAt:S()}),await ie(t,{currentPage:d})}static async addBook({userId:e,author:a,title:n,pageCount:d,currentPage:i,isbn:t}){const l=U(R,"users",e);await oe(F(R,"users",e,"books"),{author:a,currentPage:i,finished:!1,owner:l,pageCount:d,pagesRead:0,timeRead:0,title:n,isbn:t,updatedAt:S(),createdAt:S()})}static async updateBook({userId:e,bookId:a,author:n,title:d,pageCount:i,isbn:t}){const l=U(R,"users",e,"books",a);await ie(l,{author:n,title:d,pageCount:i,isbn:t,updatedAt:S()})}static async deleteBook(e,a){const n=U(R,"users",e,"books",a);await na(n)}}var pa=D('<input id="author" class="form-control" type="text" placeholder="Name of author(s)"/>'),_a=D('<input id="title" class="form-control" type="text" placeholder="Book title"/>'),ha=D('<input id="pageCount" class="form-control" type="number" placeholder="How many pages are there?"/>'),ba=D('<input id="currentPage" class="form-control" type="number" placeholder="Have you already started reading?"/>'),ma=D('<input id="isbn" class="form-control" type="text" placeholder="ISBN"/>'),ka=D('<!> <div class="space svelte-p2qnds"></div> <!> <div class="space svelte-p2qnds"></div> <!> <div class="space svelte-p2qnds"></div> <!> <div class="space svelte-p2qnds"></div> <!>',1);function Ia(r,e){Ce(e,!0);let a=H(e,"book",3,null),n=L(O(a()?a().author:"")),d=L(O(a()?a().title:"")),i=L(O(a()?a().pageCount:void 0)),t=L(O(a()?a().currentPage:1)),l=L(O(a()?a().isbn:"")),s=ne(()=>!!a());function m(){ye.addBook({userId:e.userId,author:k(n),title:k(d),pageCount:k(i),currentPage:k(t),isbn:k(l)}),e.onclose()}function c(){ye.updateBook({userId:e.userId,bookId:a().id,author:k(n),title:k(d),pageCount:k(i),isbn:k(l)}),e.onclose()}function g(){k(s)?c():m()}{let _=ne(()=>k(s)?"Edit book":"Add new book"),v=ne(()=>k(s)?"Update book":"Add book");va(r,{get open(){return e.open},onclose:()=>e.onclose(),get header(){return k(_)},get primaryText(){return k(v)},primaryAction:g,children:(E,w)=>{var o=ka(),p=fe(o);j(p,{label:"Author",inputId:"author",children:(f,x)=>{var u=pa();V(u),Y(u,()=>k(n),h=>$(n,h)),y(f,u)},$$slots:{default:!0}});var I=N(p,4);j(I,{label:"Book title",inputId:"title",children:(f,x)=>{var u=_a();V(u),Y(u,()=>k(d),h=>$(d,h)),y(f,u)},$$slots:{default:!0}});var A=N(I,4);j(A,{label:"Number of pages",inputId:"pageCount",children:(f,x)=>{var u=ha();V(u),Y(u,()=>k(i),h=>$(i,h)),y(f,u)},$$slots:{default:!0}});var b=N(A,4);j(b,{label:"Current page",inputId:"currentPage",children:(f,x)=>{var u=ba();V(u),Y(u,()=>k(t),h=>$(t,h)),y(f,u)},$$slots:{default:!0}});var q=N(b,4);j(q,{label:"ISBN number (optional)",inputId:"isbn",children:(f,x)=>{var u=ma();V(u),Y(u,()=>k(l),h=>$(l,h)),y(f,u)},$$slots:{default:!0}}),y(E,o)},$$slots:{default:!0}})}Be()}function Ta(r){return`${String(Math.floor(r/60)).padStart(2,"0")}:${String(r%60).padStart(2,"0")}`}export{ye as D,j as I,va as M,Ia as N,Aa as e,Ta as f,Ea as i};

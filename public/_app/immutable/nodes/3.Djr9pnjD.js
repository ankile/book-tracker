import{c as oe,a as C,f as J,s as f}from"../chunks/B3brjmWg.js";import{p as le,s as R,g as ie,b as ve,h as Y,f as z,a as ue,i as r,j as o,k as l,m as t,n as m,t as G}from"../chunks/COs9BhvN.js";import{D as ne,e as de,i as pe,f as ce}from"../chunks/Bw3RGzCI.js";import{a as _e,i as be,s as fe}from"../chunks/4Dd6Wes_.js";import{u as me,b as H}from"../chunks/BTWxJjmP.js";import{B as ge}from"../chunks/u-n-UfeF.js";var ke=J("<option> </option>"),he=J('<div class="controls svelte-8k5uvb"><div class="stats svelte-8k5uvb"><div class="stat svelte-8k5uvb"><span class="stat-label svelte-8k5uvb">Books Finished</span> <span class="stat-value svelte-8k5uvb"> </span></div> <div class="stat svelte-8k5uvb"><span class="stat-label svelte-8k5uvb">Total Pages</span> <span class="stat-value svelte-8k5uvb"> </span></div> <div class="stat svelte-8k5uvb"><span class="stat-label svelte-8k5uvb">Total Time</span> <span class="stat-value svelte-8k5uvb"> </span></div></div> <div class="filters svelte-8k5uvb"><div class="filter-group svelte-8k5uvb"><label class="filter-label svelte-8k5uvb" for="sort-select">Sort by</label> <select id="sort-select" class="svelte-8k5uvb"><option>Recently Finished</option><option>Title (A-Z)</option><option>Length (Pages)</option><option>Time Spent</option></select></div> <div class="filter-group svelte-8k5uvb"><label class="filter-label svelte-8k5uvb" for="year-select">Year</label> <select id="year-select" class="svelte-8k5uvb"><option>All Years</option><!></select></div></div></div> <!>',1);function Se(K,M){le(M,!0);const d=()=>_e(me,"$user",N),[N,O]=fe();let g=R("updatedAt"),p=R("all"),c=R(ie([]));ve(()=>{if(d())return ne.getBooks(d().uid,!0).subscribe(e=>{Y(c,e,!0)})});let Q=m(()=>{const a=new Set;return t(c).forEach(e=>{e.updatedAt?.toDate&&a.add(e.updatedAt.toDate().getFullYear())}),Array.from(a).sort((e,s)=>s-e)}),_=m(()=>t(p)==="all"?t(c):t(c).filter(a=>a.updatedAt?.toDate?a.updatedAt.toDate().getFullYear()===parseInt(t(p)):!1)),U=m(()=>{const a=[...t(_)];switch(t(g)){case"pageCount":return a.sort((e,s)=>(s.pageCount||0)-(e.pageCount||0));case"timeRead":return a.sort((e,s)=>(s.timeRead||0)-(e.timeRead||0));case"title":return a.sort((e,s)=>(e.title||"").localeCompare(s.title||""));case"updatedAt":default:return a.sort((e,s)=>{const i=e.updatedAt?.toDate?.()?.getTime()||0;return(s.updatedAt?.toDate?.()?.getTime()||0)-i})}}),k=m(()=>{const a=t(_).length,e=t(_).reduce((i,v)=>i+(v.pageCount||0),0),s=t(_).reduce((i,v)=>i+(v.timeRead||0),0);return{count:a,totalPages:e,totalTime:s}});var $=oe(),V=z($);{var W=a=>{var e=he(),s=z(e),i=r(s),v=r(i),F=o(r(v),2),X=r(F,!0);l(F),l(v);var h=o(v,2),P=o(r(h),2),ee=r(P,!0);l(P),l(h);var L=o(h,2),w=o(r(L),2),te=r(w,!0);l(w),l(L),l(i);var I=o(i,2),T=r(I),A=o(r(T),2),x=r(A);x.value=x.__value="updatedAt";var B=o(x);B.value=B.__value="title";var D=o(B);D.value=D.__value="pageCount";var j=o(D);j.value=j.__value="timeRead",l(A),l(T);var E=o(T,2),y=o(r(E),2),S=r(y);S.value=S.__value="all";var ae=o(S);de(ae,17,()=>t(Q),pe,(u,b)=>{var n=ke(),re=r(n,!0);l(n);var Z={};G(q=>{f(re,t(b)),Z!==(Z=q)&&(n.value=(n.__value=q)??"")},[()=>t(b).toString()]),C(u,n)}),l(y),l(E),l(I),l(s);var se=o(s,2);ge(se,{finished:!0,get userId(){return d().uid},get books(){return t(U)}}),G((u,b)=>{f(X,t(k).count),f(ee,u),f(te,b)},[()=>t(k).totalPages.toLocaleString(),()=>ce(t(k).totalTime)]),H(A,()=>t(g),u=>Y(g,u)),H(y,()=>t(p),u=>Y(p,u)),C(a,e)};be(V,a=>{d()&&a(W)})}C(K,$),ue(),O()}export{Se as component};
